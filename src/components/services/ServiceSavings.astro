---
/**
 * ServiceSavings - Savings/rebates section
 *
 * Talks about savings without showing prices.
 * Focus on rebates, energy savings, financing.
 */

import Section from '../primitives/Section.astro';
import { getBusinessProfile } from '../../lib/getBusinessProfile';

interface Savings {
  headline: string;
  description: string;
  bullets: string[];
  rebateInfo?: string;
  financingNote?: string;
}

interface Props {
  serviceTitle: string;
  location?: {
    title: string;
  };
  savings: Savings;
}

const { serviceTitle, location, savings } = Astro.props;
const profile = await getBusinessProfile();

// Generate SEO-optimized H2
const h2Text = location
  ? `${serviceTitle} Savings for ${location.title}, ON Homeowners`
  : `${serviceTitle} Savings for Ontario Homeowners`;
---

{savings && (
  <Section variant="brand">
    <div class="grid gap-10 lg:grid-cols-2 lg:gap-16 items-start">
      {/* Content */}
      <div>
        {/* Header */}
        <p class="eyebrow mb-3">Save Money</p>
        <h2 class="section-title mb-6">
          {savings.headline || h2Text}
        </h2>
        <p class="mb-6 text-base leading-relaxed text-muted-foreground">
          {savings.description}
        </p>

        {/* Bullets */}
        <ul class="space-y-4">
          {savings.bullets.map((bullet) => (
            <li class="flex items-start gap-3">
              <div class="mt-1 flex h-5 w-5 flex-shrink-0 items-center justify-center rounded-full bg-green-500 text-white">
                <svg class="h-3 w-3" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                </svg>
              </div>
              <span class="text-foreground">{bullet}</span>
            </li>
          ))}
        </ul>
      </div>

      {/* Info Cards */}
      <div class="space-y-4">
        {/* Rebate Info Card */}
        {savings.rebateInfo && (
          <div class="rounded-xl border border-green-200 bg-green-50 p-6 dark:border-green-900/30 dark:bg-green-950/20">
            <div class="mb-3 flex items-center gap-3">
              <div class="flex h-10 w-10 items-center justify-center rounded-lg bg-green-100 text-green-600 dark:bg-green-900/50 dark:text-green-400">
                <svg class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
              </div>
              <h3 class="font-bold text-green-800 dark:text-green-300">Rebate Assistance</h3>
            </div>
            <p class="text-sm text-green-700 dark:text-green-400">
              {savings.rebateInfo}
            </p>
          </div>
        )}

        {/* Financing Card */}
        {savings.financingNote && (
          <div class="rounded-xl border border-blue-200 bg-blue-50 p-6 dark:border-blue-900/30 dark:bg-blue-950/20">
            <div class="mb-3 flex items-center gap-3">
              <div class="flex h-10 w-10 items-center justify-center rounded-lg bg-blue-100 text-blue-600 dark:bg-blue-900/50 dark:text-blue-400">
                <svg class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z" />
                </svg>
              </div>
              <h3 class="font-bold text-blue-800 dark:text-blue-300">Financing Available</h3>
            </div>
            <p class="text-sm text-blue-700 dark:text-blue-400">
              {savings.financingNote}
            </p>
          </div>
        )}

        {/* CTA Card */}
        <div class="rounded-xl border border-border bg-background p-6">
          <h3 class="mb-2 font-bold text-foreground">Get Your Custom Quote</h3>
          <p class="mb-4 text-sm text-muted-foreground">
            Every home is different. Get an accurate quote with all applicable rebates calculated.
          </p>
          <div class="flex flex-col gap-3 sm:flex-row">
            <a
              href={`tel:${profile.contact.phone_e164}`}
              class="inline-flex items-center justify-center gap-2 rounded-lg bg-primary px-4 py-2.5 text-sm font-semibold text-white transition-colors hover:bg-primary/90"
            >
              <svg class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
              </svg>
              Call {profile.contact.phone_display}
            </a>
            {profile.contact.booking.enabled && (
              <a
                href={profile.contact.booking.url}
                target="_blank"
                rel="noopener noreferrer"
                class="inline-flex items-center justify-center gap-2 rounded-lg border border-border px-4 py-2.5 text-sm font-semibold text-foreground transition-colors hover:bg-muted"
              >
                Book Free Estimate
              </a>
            )}
          </div>
        </div>
      </div>
    </div>
  </Section>
)}
