---
/**
 * BlogCategoryNav Component
 *
 * A navigation component for filtering blog posts by category.
 * Allows readers to quickly find content relevant to their interests.
 *
 * Design Direction: Editorial Filtering
 * Like the category tabs in a magazine or newspaper - clean,
 * scannable, and always showing where you are. The active state
 * should be immediately clear without being distracting.
 *
 * Aesthetic Choices:
 * - Pill-style buttons for modern, touchable feel
 * - Primary color for active state signals current location
 * - Optional count badges show content depth
 * - Horizontal scroll on mobile for space efficiency
 * - Subtle hover states invite exploration
 */

interface Category {
  name: string;
  slug: string;
  count?: number;
}

interface Props {
  categories: Array<{ name: string; slug: string; count?: number }>;
  activeCategory?: string;
  showCounts?: boolean;
  allLabel?: string;
  allHref?: string;
  variant?: 'pills' | 'tabs' | 'minimal';
  class?: string;
}

const {
  categories,
  activeCategory,
  showCounts = true,
  allLabel = 'All Articles',
  allHref = '/blog/',
  variant = 'pills',
  class: className = '',
} = Astro.props;

const isAllActive = !activeCategory || activeCategory === 'all';
---

<nav class:list={['blog-category-nav', `blog-category-nav-${variant}`, className]} aria-label="Blog categories">
  <div class="blog-category-nav-inner">
    <ul class="blog-category-list" role="list">
      {/* All articles link */}
      <li class="blog-category-item">
        <a
          href={allHref}
          class:list={['blog-category-link', { 'is-active': isAllActive }]}
          aria-current={isAllActive ? 'page' : undefined}
        >
          <span class="blog-category-name">{allLabel}</span>
        </a>
      </li>

      {/* Category links */}
      {categories.map((category) => {
        const isActive = activeCategory === category.slug;
        const href = `/blog/category/${category.slug}/`;

        return (
          <li class="blog-category-item">
            <a
              href={href}
              class:list={['blog-category-link', { 'is-active': isActive }]}
              aria-current={isActive ? 'page' : undefined}
            >
              <span class="blog-category-name">{category.name}</span>
              {showCounts && category.count !== undefined && (
                <span class="blog-category-count" aria-label={`${category.count} articles`}>
                  {category.count}
                </span>
              )}
            </a>
          </li>
        );
      })}
    </ul>
  </div>
</nav>

<style>
  .blog-category-nav {
    width: 100%;
  }

  .blog-category-nav-inner {
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
    scrollbar-width: none;
    -ms-overflow-style: none;
  }

  .blog-category-nav-inner::-webkit-scrollbar {
    display: none;
  }

  .blog-category-list {
    display: flex;
    align-items: center;
    gap: var(--space-2);
    list-style: none;
    margin: 0;
    padding: var(--space-1) 0;
  }

  .blog-category-item {
    flex-shrink: 0;
  }

  /* ============================================
     VARIANT: PILLS (default)
     ============================================ */

  .blog-category-nav-pills .blog-category-link {
    display: inline-flex;
    align-items: center;
    gap: var(--space-2);
    padding: var(--space-2) var(--space-4);
    border-radius: var(--radius-full);
    font-family: var(--font-family-heading);
    font-size: var(--font-size-sm);
    font-weight: var(--font-weight-medium);
    color: var(--color-text-secondary);
    background-color: var(--color-surface-secondary);
    text-decoration: none;
    white-space: nowrap;
    transition:
      background-color var(--duration-fast) var(--ease-out),
      color var(--duration-fast) var(--ease-out),
      box-shadow var(--duration-fast) var(--ease-out);
  }

  .blog-category-nav-pills .blog-category-link:hover {
    background-color: var(--color-surface-tertiary);
    color: var(--color-text-primary);
  }

  .blog-category-nav-pills .blog-category-link:focus-visible {
    outline: 2px solid var(--color-border-focus);
    outline-offset: 2px;
  }

  .blog-category-nav-pills .blog-category-link.is-active {
    background-color: var(--color-primary-600);
    color: var(--color-text-inverse);
    box-shadow: var(--shadow-primary);
  }

  .blog-category-nav-pills .blog-category-link.is-active:hover {
    background-color: var(--color-primary-700);
  }

  .blog-category-nav-pills .blog-category-count {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    min-width: 1.25rem;
    height: 1.25rem;
    padding: 0 var(--space-1-5);
    border-radius: var(--radius-full);
    font-size: var(--font-size-xs);
    font-weight: var(--font-weight-semibold);
    background-color: rgba(0, 0, 0, 0.08);
  }

  .blog-category-nav-pills .is-active .blog-category-count {
    background-color: rgba(255, 255, 255, 0.2);
    color: var(--color-text-inverse);
  }

  /* ============================================
     VARIANT: TABS
     ============================================ */

  .blog-category-nav-tabs .blog-category-list {
    gap: 0;
    border-bottom: 1px solid var(--color-border-primary);
  }

  .blog-category-nav-tabs .blog-category-link {
    display: inline-flex;
    align-items: center;
    gap: var(--space-2);
    padding: var(--space-3) var(--space-5);
    font-family: var(--font-family-heading);
    font-size: var(--font-size-sm);
    font-weight: var(--font-weight-medium);
    color: var(--color-text-secondary);
    text-decoration: none;
    white-space: nowrap;
    border-bottom: 2px solid transparent;
    margin-bottom: -1px;
    transition:
      color var(--duration-fast) var(--ease-out),
      border-color var(--duration-fast) var(--ease-out);
  }

  .blog-category-nav-tabs .blog-category-link:hover {
    color: var(--color-text-primary);
  }

  .blog-category-nav-tabs .blog-category-link:focus-visible {
    outline: 2px solid var(--color-border-focus);
    outline-offset: -2px;
  }

  .blog-category-nav-tabs .blog-category-link.is-active {
    color: var(--color-primary-600);
    border-bottom-color: var(--color-primary-600);
  }

  .blog-category-nav-tabs .blog-category-count {
    font-size: var(--font-size-xs);
    color: var(--color-text-tertiary);
  }

  .blog-category-nav-tabs .is-active .blog-category-count {
    color: var(--color-primary-500);
  }

  /* ============================================
     VARIANT: MINIMAL
     ============================================ */

  .blog-category-nav-minimal .blog-category-list {
    gap: var(--space-4);
  }

  .blog-category-nav-minimal .blog-category-link {
    display: inline-flex;
    align-items: center;
    gap: var(--space-1-5);
    font-family: var(--font-family-body);
    font-size: var(--font-size-sm);
    font-weight: var(--font-weight-normal);
    color: var(--color-text-secondary);
    text-decoration: none;
    white-space: nowrap;
    transition: color var(--duration-fast) var(--ease-out);
  }

  .blog-category-nav-minimal .blog-category-link:hover {
    color: var(--color-primary-600);
  }

  .blog-category-nav-minimal .blog-category-link:focus-visible {
    outline: 2px solid var(--color-border-focus);
    outline-offset: 2px;
  }

  .blog-category-nav-minimal .blog-category-link.is-active {
    color: var(--color-primary-600);
    font-weight: var(--font-weight-semibold);
  }

  .blog-category-nav-minimal .blog-category-count {
    font-size: var(--font-size-xs);
    color: var(--color-text-tertiary);
  }

  /* ============================================
     RESPONSIVE
     ============================================ */

  @media (max-width: 640px) {
    .blog-category-nav-inner {
      margin: 0 calc(-1 * var(--space-4));
      padding: 0 var(--space-4);
    }

    .blog-category-nav-pills .blog-category-link {
      padding: var(--space-2) var(--space-3);
      font-size: var(--font-size-xs);
    }

    .blog-category-nav-tabs .blog-category-link {
      padding: var(--space-2) var(--space-3);
      font-size: var(--font-size-xs);
    }
  }

  /* ============================================
     REDUCED MOTION
     ============================================ */

  @media (prefers-reduced-motion: reduce) {
    .blog-category-link {
      transition: none;
    }
  }
</style>
