---
/**
 * BlogPostHero Component
 *
 * The hero section for individual blog post pages. Creates an editorial,
 * magazine-quality reading experience that positions B.A.P as knowledgeable
 * industry experts sharing valuable insights.
 *
 * Design Direction: Editorial Expertise
 * Think of a well-designed industry publication - clean typography,
 * generous whitespace, and clear visual hierarchy. The hero should
 * make readers feel they're about to learn something valuable from
 * a trusted source.
 *
 * Aesthetic Choices:
 * - Fraunces display font for title creates warmth and authority
 * - Subtle gradient background adds depth without distraction
 * - Floating metadata feels modern and scannable
 * - Author byline builds personal connection (Paul Palmer = trust)
 * - Featured image uses cinematic 2:1 aspect ratio
 *
 * Variants:
 * - default: Standard blog post hero with title and metadata
 * - featured: Larger treatment with prominent featured image
 * - minimal: Clean text-only hero for text-focused content
 */

import Badge from '../primitives/Badge.astro';
import Avatar from '../primitives/Avatar.astro';
import Container from '../primitives/Container.astro';

interface Props {
  /** Blog post title */
  title: string;
  /** Short description/excerpt */
  description?: string;
  /** Publication date */
  publishDate: Date;
  /** Author information */
  author?: {
    name: string;
    avatar?: string;
    role?: string;
  };
  /** Post category */
  category?: string;
  /** Estimated reading time */
  readingTime?: string;
  /** Featured image */
  featuredImage?: {
    src: string;
    alt: string;
  };
  /** Display variant */
  variant?: 'default' | 'featured' | 'minimal';
  /** Optional breadcrumbs */
  breadcrumbs?: Array<{ label: string; href: string }>;
  /** Additional CSS classes */
  class?: string;
}

const {
  title,
  description,
  publishDate,
  author = { name: 'Paul Palmer', role: 'Owner' },
  category,
  readingTime,
  featuredImage,
  variant = 'default',
  breadcrumbs,
  class: className = '',
} = Astro.props;

// Format the date
const formattedDate = publishDate.toLocaleDateString('en-CA', {
  year: 'numeric',
  month: 'long',
  day: 'numeric',
});

// Category display names
const categoryNames: Record<string, string> = {
  heating: 'Heating',
  cooling: 'Cooling',
  maintenance: 'Maintenance',
  efficiency: 'Energy Efficiency',
  news: 'News',
  guides: 'Guides',
};

const categoryLabel = category ? (categoryNames[category] || category) : null;

// Variant configurations
const variantClasses: Record<string, string> = {
  default: 'blog-hero-default',
  featured: 'blog-hero-featured',
  minimal: 'blog-hero-minimal',
};

// Build class string
const heroClasses = [
  'blog-hero',
  variantClasses[variant],
  className,
].filter(Boolean).join(' ');

const hasFeaturedImage = featuredImage && variant !== 'minimal';
---

<section class={heroClasses}>
  {/* Background gradient overlay for depth */}
  <div class="blog-hero-bg" aria-hidden="true" />

  <Container size="lg" class="blog-hero-container">
    {/* Breadcrumbs */}
    {breadcrumbs && breadcrumbs.length > 0 && (
      <nav class="blog-hero-breadcrumbs" aria-label="Breadcrumb">
        <ol class="breadcrumb-list">
          {breadcrumbs.map((crumb, index) => (
            <li class="breadcrumb-item">
              {index < breadcrumbs.length - 1 ? (
                <>
                  <a href={crumb.href} class="breadcrumb-link">{crumb.label}</a>
                  <span class="breadcrumb-separator" aria-hidden="true">/</span>
                </>
              ) : (
                <span class="breadcrumb-current" aria-current="page">{crumb.label}</span>
              )}
            </li>
          ))}
        </ol>
      </nav>
    )}

    {/* Content wrapper */}
    <div class="blog-hero-content">
      {/* Metadata row */}
      <div class="blog-hero-meta">
        {categoryLabel && (
          <Badge variant="primary" size="sm" pill class="badge-uppercase">
            {categoryLabel}
          </Badge>
        )}
        <span class="blog-hero-date">
          <time datetime={publishDate.toISOString()}>{formattedDate}</time>
        </span>
        {readingTime && (
          <>
            <span class="blog-hero-meta-separator" aria-hidden="true">&middot;</span>
            <span class="blog-hero-reading-time">{readingTime}</span>
          </>
        )}
      </div>

      {/* Title */}
      <h1 class="blog-hero-title">{title}</h1>

      {/* Description */}
      {description && (
        <p class="blog-hero-description">{description}</p>
      )}

      {/* Author byline */}
      <div class="blog-hero-author">
        <Avatar
          src={author.avatar}
          alt={author.name}
          fallback={author.name}
          size="md"
          bordered
          borderColor="primary"
          variant="primary"
        />
        <div class="blog-hero-author-info">
          <span class="blog-hero-author-name">{author.name}</span>
          {author.role && (
            <span class="blog-hero-author-role">{author.role}</span>
          )}
        </div>
      </div>
    </div>

    {/* Featured image */}
    {hasFeaturedImage && (
      <figure class="blog-hero-image-wrapper">
        <div class="blog-hero-image-container">
          <img
            src={featuredImage.src}
            alt={featuredImage.alt}
            class="blog-hero-image"
            loading="eager"
            decoding="async"
          />
          {/* Subtle corner accents */}
          <div class="blog-hero-image-accent blog-hero-image-accent-tl" aria-hidden="true" />
          <div class="blog-hero-image-accent blog-hero-image-accent-br" aria-hidden="true" />
        </div>
      </figure>
    )}
  </Container>

  {/* Decorative bottom wave */}
  <div class="blog-hero-wave" aria-hidden="true">
    <svg viewBox="0 0 1440 48" fill="none" preserveAspectRatio="none">
      <path d="M0 48h1440V24c-240 16-480 24-720 24S240 40 0 24v24z" fill="currentColor"/>
    </svg>
  </div>
</section>

<style is:global>
  /**
   * BlogPostHero Styles
   * Editorial, magazine-quality reading experience
   */

  /* ============================================
     BASE HERO
     ============================================ */

  .blog-hero {
    position: relative;
    padding-top: var(--space-12);
    padding-bottom: var(--space-16);
    overflow: hidden;
  }

  .blog-hero-bg {
    position: absolute;
    inset: 0;
    background: linear-gradient(
      165deg,
      var(--color-surface-secondary) 0%,
      var(--color-surface-primary) 40%,
      var(--color-primary-50) 100%
    );
    z-index: 0;
  }

  .blog-hero-container {
    position: relative;
    z-index: 1;
  }

  /* ============================================
     BREADCRUMBS
     ============================================ */

  .blog-hero-breadcrumbs {
    margin-bottom: var(--space-6);
  }

  .breadcrumb-list {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    gap: var(--space-2);
    list-style: none;
    margin: 0;
    padding: 0;
  }

  .breadcrumb-item {
    display: flex;
    align-items: center;
    gap: var(--space-2);
    font-size: var(--font-size-sm);
    font-family: var(--font-family-body);
  }

  .breadcrumb-link {
    color: var(--color-text-secondary);
    text-decoration: none;
    transition: color var(--duration-fast) var(--ease-out);
  }

  .breadcrumb-link:hover {
    color: var(--color-primary-600);
    text-decoration: underline;
    text-underline-offset: 2px;
  }

  .breadcrumb-separator {
    color: var(--color-text-tertiary);
  }

  .breadcrumb-current {
    color: var(--color-text-primary);
    font-weight: var(--font-weight-medium);
  }

  /* ============================================
     CONTENT
     ============================================ */

  .blog-hero-content {
    max-width: 800px;
    text-align: center;
    margin: 0 auto;
  }

  /* Metadata row */
  .blog-hero-meta {
    display: flex;
    align-items: center;
    justify-content: center;
    flex-wrap: wrap;
    gap: var(--space-3);
    margin-bottom: var(--space-5);
  }

  .blog-hero-date,
  .blog-hero-reading-time {
    font-size: var(--font-size-sm);
    font-family: var(--font-family-body);
    color: var(--color-text-secondary);
  }

  .blog-hero-meta-separator {
    color: var(--color-text-tertiary);
    font-size: var(--font-size-sm);
  }

  /* Title */
  .blog-hero-title {
    font-family: var(--font-family-display);
    font-size: var(--font-size-display-lg);
    font-weight: var(--font-weight-semibold);
    line-height: var(--line-height-tight);
    letter-spacing: var(--letter-spacing-tight);
    color: var(--color-text-primary);
    margin: 0 0 var(--space-5) 0;
    text-wrap: balance;
  }

  /* Description */
  .blog-hero-description {
    font-size: var(--font-size-xl);
    font-family: var(--font-family-body);
    line-height: var(--line-height-relaxed);
    color: var(--color-text-secondary);
    margin: 0 0 var(--space-8) 0;
    max-width: 680px;
    margin-left: auto;
    margin-right: auto;
  }

  /* Author byline */
  .blog-hero-author {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: var(--space-3);
    margin-bottom: var(--space-10);
  }

  .blog-hero-author-info {
    display: flex;
    flex-direction: column;
    text-align: left;
  }

  .blog-hero-author-name {
    font-size: var(--font-size-base);
    font-family: var(--font-family-heading);
    font-weight: var(--font-weight-semibold);
    color: var(--color-text-primary);
    line-height: var(--line-height-snug);
  }

  .blog-hero-author-role {
    font-size: var(--font-size-sm);
    font-family: var(--font-family-body);
    color: var(--color-text-secondary);
    line-height: var(--line-height-snug);
  }

  /* ============================================
     FEATURED IMAGE
     ============================================ */

  .blog-hero-image-wrapper {
    margin: 0;
    padding: 0;
  }

  .blog-hero-image-container {
    position: relative;
    border-radius: var(--radius-xl);
    overflow: hidden;
    box-shadow: var(--shadow-xl);
    background-color: var(--color-surface-tertiary);
  }

  .blog-hero-image {
    display: block;
    width: 100%;
    aspect-ratio: 2 / 1;
    object-fit: cover;
    object-position: center;
  }

  /* Industrial accent corners */
  .blog-hero-image-accent {
    position: absolute;
    width: 40px;
    height: 40px;
    pointer-events: none;
    opacity: 0.6;
  }

  .blog-hero-image-accent-tl {
    top: -2px;
    left: -2px;
    border-top: 4px solid var(--color-primary-500);
    border-left: 4px solid var(--color-primary-500);
    border-top-left-radius: var(--radius-xl);
  }

  .blog-hero-image-accent-br {
    bottom: -2px;
    right: -2px;
    border-bottom: 4px solid var(--color-accent-500);
    border-right: 4px solid var(--color-accent-500);
    border-bottom-right-radius: var(--radius-xl);
  }

  /* ============================================
     DECORATIVE WAVE
     ============================================ */

  .blog-hero-wave {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    height: 48px;
    color: var(--color-surface-primary);
    z-index: 1;
  }

  .blog-hero-wave svg {
    display: block;
    width: 100%;
    height: 100%;
  }

  /* ============================================
     VARIANT: DEFAULT
     Standard blog post hero
     ============================================ */

  .blog-hero-default {
    padding-bottom: var(--space-20);
  }

  /* ============================================
     VARIANT: FEATURED
     Larger treatment with prominent image
     ============================================ */

  .blog-hero-featured {
    padding-top: var(--space-16);
    padding-bottom: var(--space-24);
  }

  .blog-hero-featured .blog-hero-title {
    font-size: var(--font-size-display-hero);
  }

  .blog-hero-featured .blog-hero-image-container {
    border-radius: var(--radius-2xl);
  }

  .blog-hero-featured .blog-hero-image {
    aspect-ratio: 21 / 9;
  }

  .blog-hero-featured .blog-hero-image-accent {
    width: 60px;
    height: 60px;
  }

  /* ============================================
     VARIANT: MINIMAL
     Text-only hero for focused reading
     ============================================ */

  .blog-hero-minimal {
    padding-bottom: var(--space-12);
  }

  .blog-hero-minimal .blog-hero-bg {
    background: linear-gradient(
      180deg,
      var(--color-surface-secondary) 0%,
      var(--color-surface-primary) 100%
    );
  }

  .blog-hero-minimal .blog-hero-content {
    margin-bottom: 0;
  }

  .blog-hero-minimal .blog-hero-wave {
    display: none;
  }

  /* ============================================
     RESPONSIVE ADJUSTMENTS
     ============================================ */

  @media (max-width: 768px) {
    .blog-hero {
      padding-top: var(--space-8);
      padding-bottom: var(--space-12);
    }

    .blog-hero-title {
      font-size: clamp(1.75rem, 6vw, 2.5rem);
    }

    .blog-hero-description {
      font-size: var(--font-size-lg);
    }

    .blog-hero-image {
      aspect-ratio: 16 / 9;
    }

    .blog-hero-image-accent {
      width: 24px;
      height: 24px;
    }

    .blog-hero-featured .blog-hero-image {
      aspect-ratio: 16 / 9;
    }

    .blog-hero-featured .blog-hero-image-accent {
      width: 32px;
      height: 32px;
    }
  }

  @media (max-width: 480px) {
    .blog-hero-meta {
      flex-direction: column;
      gap: var(--space-2);
    }

    .blog-hero-meta-separator {
      display: none;
    }

    .blog-hero-author {
      flex-direction: column;
      gap: var(--space-2);
    }

    .blog-hero-author-info {
      text-align: center;
    }
  }

  /* ============================================
     REDUCED MOTION
     ============================================ */

  @media (prefers-reduced-motion: reduce) {
    .blog-hero-image-accent {
      opacity: 0.4;
    }
  }
</style>
